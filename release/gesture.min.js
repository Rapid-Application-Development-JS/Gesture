!function(t,e){"function"==typeof define&&define.amd?define(function(){return t.GestureTracker=e()}):"object"==typeof module&&module.exports?module.exports=t.GestureTracker=e():t.GestureTracker=e()}(this,function(){function t(e){function n(){function t(t){return{start:{clientX:t.clientX,clientY:t.clientY,timeStamp:t.timeStamp},pre:{clientX:t.clientX,clientY:t.clientY,timeStamp:t.timeStamp},last:{clientX:t.clientX,clientY:t.clientY,timeStamp:t.timeStamp},end:{clientX:t.clientX,clientY:t.clientY,timeStamp:t.timeStamp}}}var e=this,n={},i=0;e.getCount=function(){return i},e.hasEvent=function(t){return n[t]?!0:!1},e.setNewEvent=function(a){e.hasEvent(a.pointerId)||i++,n[a.pointerId]=t(a)},e.getTrack=function(t){return n[t]},e.removeEvent=function(t){e.hasEvent(t)&&i--,n[t]=null},e.calculateDistance=function(t,e,n,i){return Math.pow((e-t)*(e-t)+(i-n)*(i-n),.5)},e.updateEvent=function(t){n[t.pointerId].pre.clientX=n[t.pointerId].last.clientX,n[t.pointerId].pre.clientY=n[t.pointerId].last.clientY,n[t.pointerId].pre.timeStamp=n[t.pointerId].last.timeStamp,n[t.pointerId].last.clientX=t.clientX,n[t.pointerId].last.clientY=t.clientY,n[t.pointerId].last.timeStamp=t.timeStamp},e.setEndEvent=function(t){n[t.pointerId].end.clientX=t.clientX,n[t.pointerId].end.clientY=t.clientY,n[t.pointerId].end.timeStamp=t.timeStamp}}function i(t,e,n){var a,o,r,c=this,l={},p=u({tapDuration:300,tapDelay:300,doubleGuardState:!0},n),s=b.GESTURE_EVENTS.tap,d=t;c.pointerDown=function(){a=!0},c.pointerMove=function(){a=!1},i.prototype={get doubleGuardState(){return p.doubleGuardState},set doubleGuardState(t){p.doubleGuardState=t}},c.setDoubleGuardState=function(){},c.pointerUp=function(t){var n=d.getTrack(t.pointerId);a&&(n.end.timeStamp-n.start.timeStamp<p.tapDuration?!r||n.end.timeStamp-r>p.tapDelay?(r=n.end.timeStamp,p.doubleGuardState?o=setTimeout(function(){e(s,t,l),o=null}.bind(c),p.tapDelay):e(s,t,l)):(p.doubleGuardState&&(clearTimeout(o),o=null),e(b.GESTURE_EVENTS.doubletap,t,l)):e(b.GESTURE_EVENTS.longtap,t,l)),a=!1}}function a(t,e){var n,i=this,a=500,o=b.GESTURE_EVENTS.hold,r={};i.pointerDown=function(t){clearTimeout(a),n=setTimeout(function(){e(o,t,r),n=null}.bind(i),a)},i.pointerMove=function(){clearTimeout(n),n=null},i.pointerUp=function(){clearTimeout(n),n=null}}function o(t,e){var n=this,i=b.GESTURE_EVENTS.fling,a={},o=50;I=t,n.pointerDown=function(){},n.pointerMove=function(){},n.pointerUp=function(t){var n=I.getTrack(t.pointerId),r=I.calculateDistance(n.end.clientX,n.pre.clientX,n.end.clientY,n.pre.clientY),c=Math.abs(r)>0&&n.end.timeStamp-n.start.timeStamp>o;c&&(a.start=n.start,a.end=n.end,a.duration=n.end.timeStamp-n.start.timeStamp,a.speedX=(n.end.clientX-n.pre.clientX)/a.duration,a.speedY=(n.end.clientY-n.pre.clientY)/a.duration,a.speed=r/a.duration,e(i,t,a))}}function r(t,e){function n(){for(var t,e,n=c.getTrack(0).last.clientX,i=c.getTrack(0).last.clientY,a=n,o=i,r=1;r!==c.getCount();r++)t=c.getTrack(r).last,n<t.clientX&&(n=t.clientX),a>t.clientX&&(a=t.clientX),i<t.clientY&&(i=t.clientY),o>t.clientY&&(o=t.clientY);return e={x:a+(n-a)/2,y:o+(i-o)/2}}var i,a=this,o=b.GESTURE_EVENTS.rotate,r={angle:0},c=t,l={rotatestart:"rotatestart",rotatemove:"rotatemove",rotateend:"rotateend"};a.pointerDown=function(){},a.pointerMove=function(t){if(c.getCount()>1){var a,u,p=n(),s=0;if(r.center=p,i){for(var d=0;d!==c.getCount();d++)a=c.getTrack(d),u=Math.atan2(p.y-a.last.clientY,p.x-a.last.clientX)/Math.PI*180,u=0>u?u+360:u,s+=u-a.pre.angle,a.pre.angle=u;s/=c.getCount(),r.action=l.rotatemove,r.angleSpin=s,r.angle+=s,e(o,t,r)}else{r.action=l.rotatestart;for(var d=0;d!==c.getCount();d++)a=c.getTrack(d),u=Math.atan2(p.y-a.last.clientY,p.x-a.last.clientX)/Math.PI*180,u=0>u?u+360:u,a.pre.angle=u;e(o,t,r)}i=p}},a.pointerUp=function(t){c.getTrack(t.pointerId);c.getCount()<2&&(r.angle=0,i=null)}}function c(t,e,n){function i(){var t=0,e=0,n=0;p.sumLast&&(p.sumPre=p.sumLast);for(var i=0;i!==s.getCount();i++)for(var a=i+1;a!==s.getCount();a++)i!==a&&(p.sumStart||(e+=s.calculateDistance(s.getTrack(i).start.clientX,s.getTrack(a).start.clientX,s.getTrack(i).start.clientY,s.getTrack(a).start.clientY)),n+=s.calculateDistance(s.getTrack(i).last.clientX,s.getTrack(a).last.clientX,s.getTrack(i).last.clientY,s.getTrack(a).last.clientY),t++);p.sumLast=n/t,p.sumPre=p.sumPre||p.sumLast,p.sumStart=p.sumStart||e/t}{var a,o=this,r=b.GESTURE_EVENTS.pinch,c=!1,l={},p={sumStart:null,sumLast:null,sumPre:null},s=t,d={pinchstart:"pinchstart",pinchmove:"pinchmove",pinchend:"pinchend",pinchin:"pinchin",pinchout:"pinchout"},m={in:"in",out:"out"};u({threshold:S},n)}o.pointerDown=function(){},o.pointerMove=function(t){if(s.getCount()>1){i();var n,o=p.sumStart-p.sumLast;l.zoom=Math.abs(p.sumLast/p.sumStart),l.pinchSize=p.sumLast,l.pointsCount=s.getCount(),c||(Math.abs(o)>.05*p.sumStart&&(l.action=d.pinchstart,e(r,t,l)),c=!0),n=l.zoom>1?m.out:m.in,l.action=d.pinchmove,e(r,t,l),(a||a!==n)&&(l.action=r+n,a=n,e(r,t,l))}},o.pointerUp=function(t){c&&(l.action=d.pinchend,l.pointsCount=s.getCount(),e(r,t,l),c=!1)}}function l(t,e,n){function i(){r=h.direction===f.all||h.direction===f.horizontal,c=h.direction===f.all||h.direction===f.vertical}function a(t,e){var n=void 0;return Math.abs(t)>Math.abs(e)?r&&(n=t>0?f.DirectionType.right:f.DirectionType.left):c&&(n=e>0?f.DirectionType.down:f.DirectionType.up),n}var o,r,c,l=this,p={},s=!1,d=t,m=b.GESTURE_EVENTS.pan,f={horizontal:"horizontal",vertical:"vertical",all:"all",DirectionType:{left:"left",right:"right",up:"up",down:"down"}},h=u({direction:f.all,threshold:S},n),v={panstart:"panstart",panmove:"panmove",panend:"panend",panleft:"panleft",panright:"panright",panup:"panup",pandown:"pandown"};i(),l.pointerDown=function(){},l.pointerMove=function(t){var n,i,r=d.getTrack(t.pointerId),c=t.clientX-r.start.clientX,l=t.clientY-r.start.clientY,u=a(c,l);!s&&u?(n=Math.abs(c)>h.threshold&&u,i=Math.abs(l)>h.threshold&&u,(n||i)&&(p.action=v.panstart,p.direction=u,p.distanceX=c,p.distanceY=l,e(m,t,p),s=!0,o=u,p.action=m+u,e(m,t,p))):u&&(p.action=v.panmove,p.direction=u,p.distanceX=c,p.distanceY=l,e(m,t,p),o!==u&&(p.action=m+u,e(m,t,p),r.start.direction=u))},l.pointerUp=function(t){if(s){var n=t.clientX-d.getTrack(t.pointerId).start.clientX,i=t.clientY-d.getTrack(t.pointerId).start.clientY;p.action=v.panend,p.direction=a(n,i),p.distanceX=n,p.distanceY=i,e(m,t,p),s=!1}}}function u(t,e){var n;for(n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function p(t,e,n){var i,a=document.createEvent("MouseEvents");if(a.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),a.pointerId=T,a.pointerType=e.pointerType,n)for(i in n)n.hasOwnProperty(i)&&(a[i]=n[i]);e.target.dispatchEvent(a)}function s(){I=new n;for(var t in X)m(Y).call(Y,X[t],y,!1);h(function(){var t,e,n=document.createElement("div");n.style.position="absolute",n.style.height="1in",n.style.width="1in",n.style.top="-100%",n.style.left="-100%",document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n),e=t*d()*screen.pixelDepth/24,S=e/6,w.push(new i(I,p),new a(I,p),new l(I,p),new o(I,p),new c(I,p),new r(I,p))})}function d(){return"devicePixelRatio"in window?window.devicePixelRatio:1}function m(t){return t.addEventListener||t.attachEvent}function f(t){return t.removeEventListener||t.detachEvent}function h(t){var e=m(document),n=f(document),i=document.addEventListener?"DOMContentLoaded":"onreadystatechange";e.call(document,i,function(){n.call(document,i,arguments.callee,!1),t()},!1)}function v(t){T=t.pointerId,I.setNewEvent(t);for(var e=0;e!=w.length;e++)w[e].pointerDown(t,I)}function E(t){var e,n,i;if(I.hasEvent(t.pointerId)&&(i=I.getTrack(t.pointerId),t.timeStamp-i.last.timeStamp>10)){if(e=Math.abs(i.last.clientX-i.start.clientX)>S,n=Math.abs(i.last.clientY-i.start.clientY)>S,e||n)for(var a=0;a!=w.length;a++)w[a].pointerMove(t,I);I.updateEvent(t,I)}}function g(t){if(I.hasEvent(t.pointerId)){I.setEndEvent(t);for(var e=0;e!=w.length;e++)w[e].pointerUp(t,I);I.removeEvent(t.pointerId)}}var S,T,X={up:"pointerup",down:"pointerdown",move:"pointermove",over:"pointerover",cancel:"pointercancel"},Y=e,b=this,w=[],y=function(t){switch(t.type){case X.down:v(t);break;case X.move:E(t);break;case X.cancel:case X.up:g(t)}}.bind(b),I=new n;b.version="1.1.0",b.GESTURE_EVENTS={hold:"hold",fling:"fling",longtap:"longtap",tap:"tap",doubletap:"doubletap",pan:"pan",pinch:"pinch",rotate:"rotate"},s(),b.destroy=function(){for(var t in this.TRACK_EVENTS)X.hasOwnProperty(t)&&f(Y).call(Y,X[t],y);Y=null},b.addGesture=function(t){w.push(t)},t.prototype={get doubleGuardState(){return w[0].doubleGuardState},set doubleGuardState(t){w[0].doubleGuardState=t}}}return t});
//# sourceMappingURL=release/gesture.min.js.map